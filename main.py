#Importing the requests library
import requests
import pandas as pd
from functions import scrape

URL = "https://api.weather.com/v2/pws/history/all?stationId=KTXPASAD198&format=json&units=e&date=20241229&numericPrecision=decimal&apiKey=e1f10a1e78da46f5b10a1e78da96f525"
stations = {'KTXHOUST2924', 'KTXHEMPS30', 'KTXHOUST4614', 'KTXHOUST3627', 'KTXANGLE175', 'KTXTEXAS1184', 'KTXSUGAR311', 'KTXANGLE54', 'KTXLAMAR51', 'KTXHOUST3784', 'KTXHOUST2719', 'KTXCYPRE652', 'KTXRICHM399', 'KTXALVIN165', 'KTXHOUST3729', 'KTXTOMBA339', 'KTXHEMPS20', 'KTXSANLE20', 'KTXFRIEN240', 'KTXKATY1031', 'KTXMISSO236', 'KTXSANTA211', 'KTXCHAPP23', 'KTXLEAGU203', 'KTXDICKI115', 'KTXSUGAR6', 'KTXPEARL163', 'KTXPEARL209', 'KTXDICKI174', 'KTXTEXAS1193', 'KTXCYPRE462', 'KTXWEBST43', 'KTXHEMPS35', 'KTXEASTB37', 'KTXFRIEN166', 'KTXMANVE113', 'KTXANGLE143', 'KTXHOUST3329', 'KTXSEALY42', 'KTXWALLE99', 'KTXHOUST4201', 'KTXTEXAS1169', 'KTXHOUST3206', 'KTXLEAGU480', 'KTXLEAGU532', 'KTXMAGNO382', 'KTXMISSO142', 'KTXLEAGU310', 'KTXMISSO57', 'KTXKATY24', 'KTXWALLI8', 'KTXHOUST4140', 'KTXKATY873', 'KTXKATY642', 'KTXLEAGU380', 'KTXMISSO164', 'KTXSUGAR297', 'KTXPEARL187', 'KTXHITCH71', 'KTXFRIEN253', 'KTXCYPRE401', 'KTXHOUST3612', 'KTXBAYOU11', 'KTXHOCKL111', 'KTXHOUST2751', 'KTXLEAGU269', 'KTXPATTI9', 'KTXHOUST3896', 'KTXKATY1005', 'KTXSANTA136', 'KTXHOUST4257', 'KTXRICHM466', 'KTXANGLE170', 'KTXHOUST2472', 'KTXALVIN124', 'KTXSUGAR391', 'KTXPEARL225', 'KTXHOUST4859', 'KTXLAMAR36', 'KTXSUGAR264', 'KTXSEALY65', 'KTXHOUST3065', 'KTXFRIEN203', 'KTXHOUST4942', 'KTXSUGAR168', 'KTXHOUST2511', 'KTXSANTA97', 'KTXLAKEJ85', 'KTXSTAFF4', 'KTXHOUST3789', 'KTXFRIEN78', 'KTXHOUST4870', 'KTXHOUST4060', 'KTXKATY40', 'KTXROSHA27', 'KTXCATSP28', 'KTXALVIN64', 'KTXHOUST4474', 'KTXCYPRE718', 'KTXSANTA205', 'KTXHOUST890', 'KTXLAKEJ32', 'KTXHOUST4498', 'KTXHOUST3441', 'KTXPEARL186', 'KTXEASTB34', 'KTXRICHW7', 'KTXPEARL182', 'KTXPEARL176', 'KTXBELLV89', 'KTXMEADO27', 'KTXANGLE135', 'KTXBELLV72', 'KTXHOUST4910', 'KTXDICKI220', 'KTXSEALY84', 'KTXMISSO130', 'KTXLEAGU26', 'KTXFRIEN119', 'KTXMAGNO392', 'KTXEASTB47', 'KTXHOUST3606', 'KTXANGLE89', 'KTXSEALY99', 'KTXLEAGU262', 'KTXSEALY86', 'KTXHOUST3200', 'KTXHOUST4364', 'KTXHOUST3903', 'KTXTEXAS1186', 'KTXPEARL332', 'KTXHEMPS25', 'KTXSEALY80', 'KTXCYPRE889', 'KTXLEAGU207', 'KTXROSHA70', 'KTXMISSO129', 'KTXGALVE479', 'KTXKATY1032', 'KTXRICHM489', 'KTXLEAGU96', 'KTXMANVE94', 'KTXBRAZO74', 'KTXDICKI5', 'KTXSEALY78', 'KTXEASTB55', 'KTXHOUST3689', 'KTXHOUST3083', 'KTXPEARL326', 'KTXHOUST4815', 'KTXKATY713', 'KTXTOMBA241', 'KTXMISSO205', 'KTXLAKEJ107', 'KTXHOUST4035', 'KTXDICKI175', 'KTXALVIN156', 'KTXSANTA10', 'KTXDICKI197', 'KTXSEALY52', 'KTXHOUST2926', 'KTXHOUST4810', 'KTXDICKI222', 'KTXDAMON49', 'KTXMANVE119', 'KTXMISSO73', 'KTXSUGAR273', 'KTXFULSH59', 'KTXHOUST3066', 'KTXFULSH192', 'KTXSUGAR289', 'KTXPEARL314', 'KTXHOUST4198', 'KTXBROOK65', 'KTXHOUST2410', 'KTXHOUST265', 'KTXHOUST3267', 'KTXMISSO207', 'KTXSEALY57', 'KTXHOUST3943', 'KTXHOUST2589', 'KTXLEAGU290', 'KTXSANTA81', 'KTXSUGAR136', 'KTXHOUST3746', 'KTXPEARL421', 'KTXBELLA32', 'KTXHOUST600', 'KTXHOUST3338', 'KTXWALLI12', 'KTXHOUST2780', 'KTXHOUST2579', 'KTXPEARL409', 'KTXSUGAR313', 'KTXLEAGU525', 'KTXHOUST4931', 'KTXHOUST4882', 'KTXFRIEN150', 'KTXROSEN97', 'KTXHOUST4515', 'KTXLEAGU409', 'KTXLEAGU475', 'KTXHOUST4025', 'KTXFREEP106', 'KTXPEARL232', 'KTXHOUST3192', 'KTXLEAGU506', 'KTXHOCKL42', 'KTXDICKI69', 'KTXHOUST3257', 'KTXSEALY30', 'KTXMISSO232', 'KTXROSHA54', 'KTXSANTA123', 'KTXMISSO141', 'KTXBROOK30', 'KTXHOUST4937', 'KTXROSHA17', 'KTXHOUST42', 'KTXLAKEJ99', 'KTXALVIN73', 'KTXLEAGU394', 'KTXBELLV77', 'KTXSUGAR256', 'KTXKATY89', 'KTXSURFS7', 'KTXKATY888', 'KTXHOUST2597', 'KTXHOUST4430', 'KTXHOUST2478', 'KTXSUGAR347', 'KTXDICKI237', 'KTXSUGAR131', 'KTXLEAGU36', 'KTXKATY25', 'KTXMISSO132', 'KTXHOUST4717', 'KTXHITCH61', 'KTXMANVE118', 'KTXGALVE484', 'KTXHOUST880', 'KTXHOUST2940', 'KTXHOUST4242', 'KTXHOUST78', 'KTXSUGAR379', 'KTXALVIN148', 'KTXBELLV97', 'KTXRICHM432', 'KTXHOUST4794', 'KTXHOUST3883', 'KTXBACLI80', 'KTXSANTA132', 'KTXKATY779', 'KTXRICHM299', 'KTXHOUST3665', 'KTXSUGAR387', 'KTXHOUST3578', 'KTXHOUST3089', 'KTXANGLE93', 'KTXSANLE52', 'KTXTEXAS1173', 'KTXMISSO86', 'KTXPEARL375', 'KTXHOUST4791', 'KTXROSEN79', 'KTXMAGNO15', 'KTXHOUST2336', 'KTXHOUST3728', 'KTXHOUST4002', 'KTXALVIN71', 'KTXPEARL238', 'KTXCYPRE736', 'KTXHOUST4841', 'KTXTEXAS1188', 'KTXSANTA167', 'KTXHOUST3212', 'KTXKATY221', 'KTXLAKEJ100', 'KTXHOUST2835', 'KTXMISSO111', 'KTXCYPRE846', 'KTXSUGAR213', 'KTXPEARL257', 'KTXPEARL357', 'KTXBRAZO65', 'KTXHOUST1946', 'KTXHOUST4892', 'KTXMISSO214', 'KTXWALLI27', 'KTXKATY1039', 'KTXALVIN196', 'KTXSUGAR383', 'KTXHOUST4125', 'KTXHEMPS68', 'KTXDICKI227', 'KTXDICKI204', 'KTXCYPRE105', 'KTXSEALY97', 'KTXKATY774', 'KTXFREEP105', 'KTXGALVE454', 'KTXKATY333', 'KTXHEMPS79', 'KTXFREEP112', 'KTXSTAFF8', 'KTXHOUST394', 'KTXCYPRE506', 'KTXSEALY96', 'KTXSUGAR309', 'KTXHOUST4108', 'KTXALVIN45', 'KTXHOUST3045', 'KTXALVIN72', 'KTXCYPRE686', 'KTXIOWAC4', 'KTXSANTA170', 'KTXLEAGU533', 'KTXRICHM394', 'KTXHOUST4766', 'KTXHOUST4256', 'KTXHOUST4857', 'KTXROSHA62', 'KTXMANVE49', 'KTXHOUST3998', 'KTXHOUST3738', 'KTXLEAGU48', 'KTXHOUST1998', 'KTXKATY805', 'KTXWALLE104', 'KTXWALLE33', 'KTXALVIN8', 'KTXSEALY82', 'KTXBELLV24', 'KTXWEBST27', 'KTXHOUST2978', 'KTXJAMAI10', 'KTXSURFS11', 'KTXGALVE221', 'KTXHOUST3919', 'KTXMANVE115', 'KTXROSHA44', 'KTXPEARL193', 'KTXHOUST2226', 'KTXHOUST2659', 'KTXFULSH187', 'KTXMAGNO89', 'KTXPEARL296', 'KTXGALVE187', 'KTXHOUST3561', 'KTXSANTA135', 'KTXHOUST3787', 'KTXHOUST4806', 'KTXCYPRE818', 'KTXSANTA157', 'KTXCYPRE444', 'KTXMISSO200', 'KTXHOUST4523', 'KTXPEARL383', 'KTXHOUST4726', 'KTXHOUST4874', 'KTXPEARL78', 'KTXEASTB30', 'KTXROSEN12', 'KTXGALVE326', 'KTXWALLE101', 'KTXHEMPS78', 'KTXHOUST4063', 'KTXSUGAR245', 'KTXDICKI239', 'KTXHOUST2039', 'KTXDICKI234', 'KTXCYPRE358', 'KTXFRIEN212', 'KTXKATY396', 'KTXHOUST3288', 'KTXHOUST3760', 'KTXKATY916', 'KTXROSEN49', 'KTXROSHA81', 'KTXBRAZO32', 'KTXALVIN87', 'KTXTOMBA417', 'KTXHOUST3188', 'KTXTOMBA317', 'KTXSEALY66', 'KTXMISSO67', 'KTXLEAGU560', 'KTXSEALY81', 'KTXSUGAR319', 'KTXHOUST4666', 'KTXBELLV1', 'KTXHOUST4429', 'KTXALVIN20', 'KTXRICHM573', 'KTXBELLV76', 'KTXANGLE160', 'KTXHOUST4050', 'KTXSANTA201', 'KTXHOCKL37', 'KTXDICKI83', 'KTXRICHM558', 'KTXANGLE178', 'KTXHOUST2957', 'KTXALVIN94', 'KTXHOUST3804', 'KTXWALLE43', 'KTXWALLE45', 'KTXPEARL407', 'KTXHOUST4443', 'KTXHITCH68', 'KTXMISSO135', 'KTXKATY623', 'KTXKATY446', 'KTXRICHM383', 'KTXHOUST314', 'KTXWALLE81', 'KTXALVIN83', 'KTXSUGAR389', 'KTXGALVE356', 'KTXIOWAC5', 'KTXSUGAR233', 'KTXSUGAR174', 'KTXGALVE446', 'KTXGALVE237', 'KTXFRIEN132', 'KTXPEARL267', 'KTXLAMAR27', 'KTXSEALY85', 'KTXHOUST3161', 'KTXBELLA15', 'KTXSUGAR299', 'KTXROSHA57', 'KTXMANVE3', 'KTXHOUST4816', 'KTXLEAGU382', 'KTXMISSO235', 'KTXHOUST3310', 'KTXALVIN186', 'KTXDANBU19', 'KTXHOUST1898', 'KTXALVIN76', 'KTXROSEN43', 'KTXFRIEN39', 'KTXLEAGU300', 'KTXHOUST3085', 'KTXDICKI158', 'KTXLAMAR38', 'KTXHOUST3016', 'KTXHOUST3912', 'KTXPEARL391', 'KTXHOUST4113', 'KTXFULSH136', 'KTXHOUST4566', 'KTXHOUST63', 'KTXHOUST4531', 'KTXHOUST3294', 'KTXHOUST2880', 'KTXSANTA161', 'KTXROSHA59', 'KTXFULSH178', 'KTXSUGAR371', 'KTXHOUST2145', 'KTXHOUST2704', 'KTXHEMPS50', 'KTXRICHM498', 'KTXLAKEJ90', 'KTXHOUST3881', 'KTXHOUST4896', 'KTXDICKI223', 'KTXBROOK90', 'KTXGALVE200', 'KTXLAKEJ79', 'KTXLEAGU439', 'KTXHOUST4012', 'KTXBELLV81', 'KTXMEADO32', 'KTXKATY1077', 'KTXFULSH90', 'KTXHOUST3694', 'KTXFRIEN155', 'KTXSANTA203', 'KTXSUGAR366', 'KTXKATY1041', 'KTTXRICH2', 'KTXBELLV86', 'KTXDAMON33', 'KTXLAKEJ126', 'KTXCYPRE810', 'KTXHOUST3781', 'KTXPINEH29', 'KTXHOUST4409', 'KTXSEALY11', 'KTXHOUST2007', 'KTXHOUST2857', 'KTXBELLV102', 'KTXHOUST4179', 'KTXKATY177', 'KTXKATY36', 'KTXHOCKL109', 'KTXHOUST3099', 'KTXSUGAR275', 'KTXWALLI7', 'KTXCYPRE714', 'KTXANGLE90', 'KTXHOUST4151', 'KTXSUGAR109', 'KTXMAGNO428', 'KTXHOCKL102', 'KTXANGLE148', 'KTXBELLV61', 'KTXHOUST3417', 'KTXTEXAS1037', 'KTXLEAGU511', 'KTXALVIN150', 'KTXMAGNO378', 'KTXKATY910', 'KTXBROOK78', 'KTXHOUST3312', 'KTXROSHA69', 'KTXRICHM337', 'KTXHOCKL54', 'KTXPEARL62', 'KTXHOUST4033', 'KTXKATY614', 'KTXMANVE109', 'KTXFRIEN235', 'KTXMANVE50', 'KTXCYPRE453', 'KTXHOUST4862', 'KTXLEAGU178', 'KTXHOUST4496', 'KTXHOCKL105', 'KTXKATY867', 'KTXHOUST4594', 'KTXHOUST737', 'KTXHOUST3314', 'KTXLISSI7', 'KTXHOUST2078', 'KTXSANLE35', 'KTXHEDWI4', 'KTXFULSH171', 'KTXPEARL396', 'KTXALVIN183', 'KTXALVIN200', 'KTXLEAGU454', 'KTXHOUST2663', 'KTXHOUST4478', 'KTXHOUST4170', 'KTXCYPRE601', 'KTXPEARL355', 'KTXHOUST4880', 'KTXPEARL245', 'KTXRICHM527', 'KTXHOUST4091', 'KTXALVIN198', 'KTXROSHA64', 'KTXHOUST2479', 'KTXTEXAS1133', 'KTXHOUST4230', 'KTXWALLI11', 'KTXHOUST2251', 'KTXLEAGU109', 'KTXHOUST2633', 'KTXCYPRE517', 'KTXCYPRE595', 'KTXSANTA37', 'KTXHOUST4933', 'KTXPEARL53', 'KTXHOUST422', 'KTXFRIEN193', 'KTXPEARL285', 'KTXWALLE39', 'KTXGALVE374', 'KTXTEXAS1139', 'KTXHOUST4869', 'KTXHOUST4570', 'KTXLEAGU535', 'KTXHOUST4248', 'KTXLEAGU555', 'KTXHOUST3971', 'KTXWALLI29', 'KTXDICKI147', 'KTXPEARL328', 'KTXSTAFF5', 'KTXHEMPS55', 'KTXEAGLE7', 'KTXHOUST4711', 'KTXHOUST3154', 'KTXROSHA65', 'KTXHEMPS82', 'KTXBAYOU25', 'KTXBELLA20', 'KTXMANVE47', 'KTXHOUST1941', 'KTXHOUST3355', 'KTXTEXAS1069', 'KTXEASTB10', 'KTXALVIN205', 'KTXMANVE48', 'KTXBROOK79', 'KTXDICKI229', 'KTXHOUST4908', 'KTXSUGAR360', 'KTXALVIN177', 'KTXTOMBA111', 'KTXHOUST3275', 'KTXCYPRE937', 'KTXALVIN195', 'KTXHOUST4196', 'KTXKATY43', 'KTXHOUST4886', 'KTXGALVE486', 'KTXMISSO186', 'KTXTOMBA109', 'KTXBELLV42', 'KTXMANVE59', 'KTXHOUST4878', 'KTXRICHW6', 'KTXHEMPS71', 'KTXMISSO213', 'KTXHOUST4642', 'KTXPEARL395', 'KTXHOUST2426', 'KTXFRESN6', 'KTXPEARL392', 'KTXANGLE121', 'KTXDANBU16', 'KTXHOUST3114', 'KTXALVIN129', 'KTXSANTA143', 'KTXWALLE107', 'KTXCYPRE719', 'KTXDICKI161', 'KTXHOUST3780', 'KTXBRAZO47', 'KTXALVIN187', 'KTXHOUST3715', 'KTXFRIEN170', 'KTXHOUST4354', 'KTXANGLE123', 'KTXBELLA23', 'KTXHOUST4162', 'KTXMISSO173', 'KTXHOUST4567', 'KTXHOUST4579', 'KTXEASTB63', 'KTXANGLE116', 'KTXANGLE58', 'KTXHOUST4134', 'KTXHOUST3994', 'KTXCYPRE319', 'KTXKATY1070', 'KTXHOUST2947', 'KTXKATY741', 'KTXFULSH83', 'KTXPEARL312', 'KTXMISSO184', 'KTXSUGAR393', 'KTXBRAZO53', 'KTXSANTA158', 'KTXBRAZO89', 'KTXCYPRE463', 'KTXHOUST1903', 'KTXSUGAR116', 'KTXROSEN50', 'KTXALVIN140', 'KTXHOUST4530', 'KTXDICKI135', 'KTXCYPRE901', 'KTXSANLE49', 'KTXTEXAS1128', 'KTXTEXAS1174', 'KTXFULSH127', 'KTXROSHA36', 'KTXSANTA66', 'KTXANGLE39', 'KTXLEAGU341', 'KTXHOUST4615', 'KTXPEARL273', 'KTXALVIN184', 'KTXHOUST385', 'KTXPEARL393', 'KTXSANTA118', 'KTXALVIN193', 'KTXHOCKL99', 'KTXMANVE65', 'KTXHOUST4696', 'KTXHOUST4809', 'KTXBELLA27', 'KTXHOUST3515', 'KTXRICHM388', 'KTXRICHM560', 'KTXHOUST327', 'KTXANGLE59', 'KTXPATTI8', 'KTXHOLID8', 'KTXALVIN172', 'KTXLEAGU219', 'KTXPEARL144', 'KTXALVIN79', 'KTXMANVE110'}


#ds = scrape.getDayofAllStations('20241230', stations)
ds = scrape.getDays('20241101', '20241130', 'KTXBELLA15')
print(ds)